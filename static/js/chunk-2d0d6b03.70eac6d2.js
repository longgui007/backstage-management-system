(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d6b03"],{"742b":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-card",[r("div",[r("CategorySelect",{attrs:{show:0==e.scence},on:{getCategoryId:e.getCategoryId}})],1)]),r("el-card",{staticStyle:{"margin-top":"30px"}},[r("div",{directives:[{name:"show",rawName:"v-show",value:0==e.scence,expression:"scence==0"}]},[r("el-button",{attrs:{type:"primary",icon:"el-icon-plus",disabled:!e.category3Id},on:{click:e.addSpu}},[e._v("添加SPU")]),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.spuTableData,border:""}},[r("el-table-column",{attrs:{type:"index",label:"序号",width:"80",align:"center"}}),r("el-table-column",{attrs:{prop:"spuName",label:"SPU名称",width:"width"}}),r("el-table-column",{attrs:{prop:"description",label:"SPU描述",width:"width"}}),r("el-table-column",{attrs:{prop:"prop",label:"操作",width:"width"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;t.$index;return[r("div",[r("HintButton",{attrs:{icon:"el-icon-plus",title:"添加sku",size:"mini",type:"success"},on:{click:e.addSku}}),r("HintButton",{attrs:{icon:"el-icon-edit",title:"修改spu",size:"mini",type:"warning"},on:{click:function(t){return e.updateSpu(a)}}}),r("HintButton",{attrs:{icon:"el-icon-info",title:"查看当前spu全部sku列表",size:"mini",type:"info"}}),r("el-popconfirm",{attrs:{title:"设施"}}),r("el-popconfirm",{attrs:{title:"这是一段内容确定删除吗？"},on:{onConfirm:function(t){return e.deletSpu(a)}}},[r("HintButton",{attrs:{slot:"reference",icon:"el-icon-delete",title:"删除spu",size:"mini",type:"danger"},slot:"reference"})],1)],1)]}}])})],1),r("el-pagination",{staticStyle:{"text-align":"center"},attrs:{"current-page":e.page,"page-sizes":[3,5,8],"page-size":e.limit,layout:" prev, pager, next, jumper,->,sizes,total",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("div",{directives:[{name:"show",rawName:"v-show",value:1==e.scence,expression:"scence==1"}]},[r("SpuFrom",{ref:"spu",attrs:{spuId:e.spuId},on:{changeScence:e.changeScence}})],1),r("div",{directives:[{name:"show",rawName:"v-show",value:2==e.scence,expression:"scence==2"}]},[r("SkuFrom",{ref:"sku",on:{changeScence:e.changeScence}})],1)])],1)},n=[],i=r("1da1"),s=(r("96cf"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e._v(" skuform "),r("div",[r("el-button",{attrs:{type:"primary"}},[e._v("保存")]),r("el-button",{attrs:{type:"default"},on:{click:e.cancle}},[e._v("取消")])],1)])}),o=[],c={name:"skuFrom",methods:{cancle:function(){this.$emit("changeScence",{scence:0})}}},l=c,u=r("2877"),d=Object(u["a"])(l,s,o,!1,null,null,null),p=d.exports,m=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-form",{ref:"spuForm",attrs:{model:e.spuForm,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"SPU名称"}},[r("el-input",{model:{value:e.spuForm.spuName,callback:function(t){e.$set(e.spuForm,"spuName",t)},expression:"spuForm.spuName"}})],1),r("el-form-item",{attrs:{label:"品牌"}},[r("el-select",{attrs:{placeholder:"请选择品牌"},model:{value:e.spuForm.tmId,callback:function(t){e.$set(e.spuForm,"tmId",t)},expression:"spuForm.tmId"}},e._l(e.trademarkList,(function(e,t){return r("el-option",{attrs:{label:e.tmName,value:e.id}})})),1)],1),r("el-form-item",{attrs:{label:"SPU描述"}},[r("el-input",{attrs:{type:"textarea",placeholder:"描述"},model:{value:e.spuForm.description,callback:function(t){e.$set(e.spuForm,"description",t)},expression:"spuForm.description"}})],1),r("el-form-item",{attrs:{label:"SPU图片"}},[r("el-upload",{attrs:{action:"/dev-api/admin/product/fileUpload","list-type":"picture-card","on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,"on-success":e.handlerSuccess,"file-list":e.spuImageList}},[r("i",{staticClass:"el-icon-plus"})]),r("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1),r("el-form-item",{attrs:{label:"销售属性"}},[r("el-select",{attrs:{placeholder:"还有"+e.unSelectSaleAttr.length+"条未选择"},model:{value:e.attrIdAndAttrName,callback:function(t){e.attrIdAndAttrName=t},expression:"attrIdAndAttrName"}},e._l(e.unSelectSaleAttr,(function(e,t){return r("el-option",{attrs:{label:e.name,value:e.id+":"+e.name}})})),1),r("el-button",{attrs:{type:"primary",disabled:!e.attrIdAndAttrName},on:{click:e.addSaleAttr}},[e._v("添加销售属性")])],1),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.spuForm.spuSaleAttrList,border:""}},[r("el-table-column",{attrs:{type:"index",prop:"prop",label:"序号",width:"80"}}),r("el-table-column",{attrs:{prop:"saleAttrName",label:"属性名",width:"width"}}),r("el-table-column",{attrs:{prop:"spuSaleAttrValueList",label:"属性值名称列表",width:"width"}}),r("el-table-column",{attrs:{prop:"prop",label:"操作",width:"width"},scopedSlots:e._u([{key:"default",fn:function(e){e.row;return[r("el-button",{attrs:{type:"danger"}})]}}])})],1)],1),r("div",[r("el-button",{attrs:{type:"primary"},on:{click:e.addOrUpdateSpu}},[e._v("保存")]),r("el-button",{attrs:{type:"default"},on:{click:e.cancle}},[e._v("取消")])],1)],1)},h=[];function g(e){if(Array.isArray(e))return e}r("a4d3"),r("e01a"),r("d3b7"),r("d28b"),r("3ca3"),r("ddb0");function f(e,t){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i=[],s=!0,o=!1;try{for(r=r.call(e);!(s=(a=r.next()).done);s=!0)if(i.push(a.value),t&&i.length===t)break}catch(c){o=!0,n=c}finally{try{s||null==r["return"]||r["return"]()}finally{if(o)throw n}}return i}}r("fb6a"),r("b0c0"),r("a630"),r("ac1f"),r("00b4");function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function v(e,t){if(e){if("string"===typeof e)return b(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?b(e,t):void 0}}function S(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function y(e,t){return g(e)||f(e,t)||v(e,t)||S()}r("159b"),r("1276"),r("d81d"),r("4de4");var w={name:"SpuFrom",data:function(){return{dialogImageUrl:"",dialogVisible:!1,spuForm:{category3Id:"",description:"",spuImageList:[],spuName:"",spuSaleAttrList:[],tmId:""},saleAttrList:[],trademarkList:[],saleData:[],attrIdAndAttrName:"",spuImageList:[]}},props:["spuId"],mounted:function(){this.getTrademarkList(),this.getSaleAttrList()},methods:{getSpuData:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$API.spu.reqSpu(e.id);case 2:return a=r.sent,200==a.code&&(t.spuForm=a.data),r.next=6,t.$API.spu.reqSpuImageList(e.id);case 6:n=r.sent,200==n.code&&(i=n.data,i.forEach((function(e){e.name=e.imgName,e.url=e.imgUrl})),t.spuImageList=i);case 8:case"end":return r.stop()}}),r)})))()},cancle:function(){this.$emit("changeScence",{scence:0}),Object.assign(this._data,this.$options.data())},getTrademarkList:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$API.spu.reqTradeMarkList();case 2:r=t.sent,200==r.code&&(e.trademarkList=r.data);case 4:case"end":return t.stop()}}),t)})))()},getSaleAttrList:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$API.spu.reqSaleAttrList();case 2:r=t.sent,200==r.code&&(e.saleAttrList=r.data);case 4:case"end":return t.stop()}}),t)})))()},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},handleRemove:function(e,t){this.spuImageList=t},handlerSuccess:function(e,t,r){this.spuImageList=r},addSaleAttr:function(){var e=this.attrIdAndAttrName.split(":"),t=y(e,2),r=t[0],a=t[1],n={baseSaleAttrId:r,saleAttrName:a,spuSaleAttrValueList:[]};this.spuForm.spuSaleAttrList.push(n),this.attrIdAndAttrName=""},addOrUpdateSpu:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.spuForm.spuImageList=e.spuImageList.map((function(e){return{imageName:e.name,imageUrl:e.response&&e.response.data||e.url}})),t.next=3,e.$API.spu.reqAddOrUpdateSpu(e.spuForm);case 3:r=t.sent,200==r.code&&(e.$message({type:"success",message:"保存成功"}),e.$emit("changeScence",{scence:0,flag:e.spuForm.id?"修改":"添加"})),Object.assign(e._data,e.$options.data());case 6:case"end":return t.stop()}}),t)})))()}},computed:{unSelectSaleAttr:function(){var e=this,t=this.saleAttrList.filter((function(t){return e.spuForm.spuSaleAttrList.every((function(e){return t.name!=e.saleAttrName}))}));return t}}},I=w,A=Object(u["a"])(I,m,h,!1,null,null,null),k=A.exports,L={name:"spu",data:function(){return{categoryShow:!0,spuTableData:[],page:1,limit:3,total:3,category1Id:"",category2Id:"",category3Id:"",scence:"",spuId:""}},mounted:function(){this.getSpuList()},methods:{getSpuList:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,a,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.page,a=e.limit,n=e.category3Id,t.next=3,e.$API.spu.reqGetSPUList(r,a,n);case 3:i=t.sent,console.log(i),200==i.code&&(e.spuTableData=i.data.records,e.total=i.data.total);case 6:case"end":return t.stop()}}),t)})))()},getCategoryId:function(e){e.category1Id?this.category1Id=e.category1Id:e.category2Id?this.category2Id=e.category2Id:e.category3Id&&(this.category3Id=e.category3Id,this.getSpuList())},handleSizeChange:function(e){this.limit=e,this.getSpuList()},handleCurrentChange:function(e){this.page=e,this.getSpuList()},changeScence:function(e){this.scence=e.scence},addSpu:function(){this.scence=1},addSku:function(){this.scence=2},updateSpu:function(e){this.scence=1,this.spuId=e.id,this.$refs.spu.getSpuData(e)},deletSpu:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$API.spu.reqDeleteSpu(e.id);case 2:a=r.sent,200==a.code&&t.getSpuList();case 4:case"end":return r.stop()}}),r)})))()}},components:{SkuFrom:p,SpuFrom:k}},x=L,F=Object(u["a"])(x,a,n,!1,null,null,null);t["default"]=F.exports}}]);